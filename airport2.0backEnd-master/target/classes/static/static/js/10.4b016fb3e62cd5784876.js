webpackJsonp([10],{P8lm:function(e,t){},cNtl:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("lC5x"),a=r.n(s),o=r("J0Oq"),n=r.n(o),l=r("3cXf"),i=r.n(l),u=r("a3Yh"),c=r.n(u),d={data:function(){var e,t=this;return e={findUserInput:"",roleValue:"",usersTable:""},c()(e,"usersTable",[]),c()(e,"multipleSelection",[]),c()(e,"subUsersTable",[]),c()(e,"currentPage",1),c()(e,"totalCount",0),c()(e,"pageSizes",[3,5,8]),c()(e,"PageSize",8),c()(e,"userCheck",{msg:"用户名长度应在2-16"}),c()(e,"addFormDialog",!1),c()(e,"addForm",{username:"",password:"",role:""}),c()(e,"addFormRules",{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:16,message:"长度为2~16个字符",trigger:["blur","change"]},{validator:function(e,r,s){t.checkUserExist(),0!=t.userCheck.code?s(new Error(t.userCheck.msg)):1==t.userCheck.data&&s(new Error("用户名已存在"))},trigger:["blur","change"]}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:10,message:"长度为6~10个字符",trigger:"blur"}],role:[{required:!0,message:"请输入角色",trigger:"blur"}]}),c()(e,"editDialog",!1),c()(e,"editForm",{}),c()(e,"currentUser",{}),c()(e,"editFormRules",{password:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:10,message:"长度为6~10个字符",trigger:"blur"}]}),c()(e,"delUserDialog",!1),c()(e,"delectFormDialog",!1),c()(e,"rolesOptions",[{value:"admin",label:"admin"},{value:"ordinary",label:"ordinary"}]),c()(e,"roleValue",""),e},created:function(){var e=this;this.getUsers().then(function(){e.totalCount=e.usersTable.length,e.subUsersTable=JSON.parse(i()(e.usersTable))})},filters:{noShowPassword:function(e){for(var t=e.length,r="",s=0;s<t;s++)r+="*";return r}},watch:{findUserInput:function(){this.usersTable=JSON.parse(i()(this.subUsersTable));for(var e=this.findUserInput,t=[],r=0;r<this.usersTable.length;r++)-1!=this.usersTable[r].username.indexOf(e)&&t.push(this.usersTable[r]);this.usersTable=t,this.totalCount=this.usersTable.length},roleValue:function(){this.usersTable=JSON.parse(i()(this.subUsersTable));for(var e=this.roleValue,t=[],r=0;r<this.usersTable.length;r++)-1!=this.usersTable[r].name.indexOf(e)&&t.push(this.usersTable[r]);this.usersTable=t,this.totalCount=this.usersTable.length}},methods:{checkUserExist:function(){var e=this;this.$axios({method:"get",url:"/user/checkUserExist?username="+this.addForm.username,headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(t){e.userCheck=t.data})},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.PageSize=e,this.currentPage=1},handleCurrentChange:function(e){this.currentPage=e},resetAddForm:function(){this.$refs.addFormRef.resetFields()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},getUsers:function(){var e=this;return n()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios({method:"get",url:"/user/selectAllUsers",headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(t){e.usersTable=t.data,console.log(e.usersTable)});case 2:case"end":return t.stop()}},t,e)}))()},addUser:function(){var e=this;return n()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={username:e.addForm.username,password:e.addForm.password,name:e.addForm.role},t.next=3,e.$axios({method:"post",url:"/user/insertUser",data:r,headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(){e.addFormDialog=!1,e.roleValue="",e.getUsers().then(function(){e.totalCount=e.usersTable.length})});case 3:case"end":return t.stop()}},t,e)}))()},openEditFrom:function(e){this.currentUser=e,this.editForm.username=e.username,this.editForm.name=e.name,this.editDialog=!0},editUser:function(){var e=this;return n()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={id:e.currentUser.id,password:e.editForm.password},t.next=3,e.$axios({method:"post",url:"/user/updatePS",data:r,headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(){e.editDialog=!1,e.getUsers()}).then(function(){e.$message({message:"密码修改成功！",type:"success",offset:0,center:!0,duration:3e3})});case 3:case"end":return t.stop()}},t,e)}))()},delectname:function(){var e=this;return n()(a.a.mark(function t(){var r,s,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log(e.multipleSelection),r=[],s=0;s<e.multipleSelection.length;s++)o={id:e.multipleSelection[s].id},r.push(o);return console.log(r),t.next=6,e.$axios({method:"post",url:"/user/condeleteUser",data:r,headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(){e.delectFormDialog=!1,e.getUsers().then(function(){e.totalCount=e.usersTable.length,e.currentPage=1})}).then(function(){e.$message({message:"删除用户成功！",type:"success",offset:0,center:!0,duration:3e3})});case 6:case"end":return t.stop()}},t,e)}))()},openDelDialog:function(e){this.currentUser=e,this.delUserDialog=!0},delUser:function(){var e=this;return n()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={id:e.currentUser.id},t.next=3,e.$axios({method:"post",url:"/user/deleteUser",data:r,headers:c()({token:window.sessionStorage.token,"Content-type":"x-www-form-urlencoded;charset=UTF-8"},"Content-type","application/json")}).then(function(){e.delUserDialog=!1,e.getUsers().then(function(){e.totalCount=e.usersTable.length,e.currentPage=1})}).then(function(){e.$message({message:"删除用户成功！",type:"success",offset:0,center:!0,duration:3e3})});case 3:case"end":return t.stop()}},t,e)}))()}}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{height:"100px",width:"100%"}},[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-user-solid"}),e._v(" 用户管理\n        ")])],1)],1),e._v(" "),r("div",{staticClass:"container"},[r("el-header",[r("el-button",{staticClass:"opt2",attrs:{type:"primary",icon:"el-icon-set"},on:{click:function(t){e.addFormDialog=!0}}},[e._v("+新建")]),e._v(" "),r("el-button",{staticClass:"opt3",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.delectFormDialog=!0}}},[e._v("批量删除")]),e._v(" "),r("div",[r("span",{staticClass:"username"},[e._v("用户名 :")]),e._v(" "),r("el-input",{attrs:{placeholder:"请输入用户名",clearable:"",size:"small"},model:{value:e.findUserInput,callback:function(t){e.findUserInput=t},expression:"findUserInput"}})],1),e._v(" "),r("div",[r("span",{staticClass:"userrole"},[e._v("用户角色 :")]),e._v(" "),r("el-input",{attrs:{placeholder:"请输入角色",clearable:"",size:"small"},model:{value:e.roleValue,callback:function(t){e.roleValue=t},expression:"roleValue"}})],1)],1),e._v(" "),r("el-main",[r("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.usersTable.slice((e.currentPage-1)*e.PageSize,e.currentPage*e.PageSize),border:"","header-cell-class-name":"table-header","row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection","reserve-selection":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"id",label:"id",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"password",label:"密码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("noShowPassword")(t.row.password)))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"角色",align:"center",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.openEditFrom(t.row)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.openDelDialog(t.row)}}})]}}])})],1),e._v(" "),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.PageSize,total:e.totalCount},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加用户",visible:e.addFormDialog,width:"50%"},on:{"update:visible":function(t){e.addFormDialog=t},close:e.resetAddForm}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.role,callback:function(t){e.$set(e.addForm,"role",t)},expression:"addForm.role"}},e._l(e.rolesOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addFormDialog=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改用户密码",visible:e.editDialog,width:"50%"},on:{"update:visible":function(t){e.editDialog=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色",prop:"name"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新密码",prop:"password"}},[r("el-input",{model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialog=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editUser}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{visible:e.delUserDialog,width:"40%"},on:{"update:visible":function(t){e.delUserDialog=t}}},[r("h2",[e._v("确认删除吗？")]),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.delUserDialog=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.delUser}},[e._v("确定")])],1)]),e._v(" "),r("el-dialog",{attrs:{visible:e.delectFormDialog,width:"40%"},on:{"update:visible":function(t){e.delectFormDialog=t}}},[r("h2",[e._v("确认删除吗？")]),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.delectFormDialog=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.delectname}},[e._v("确定")])],1)])],1)])},staticRenderFns:[]};var p=r("C7Lr")(d,m,!1,function(e){r("P8lm")},"data-v-53e37217",null);t.default=p.exports}});
//# sourceMappingURL=10.4b016fb3e62cd5784876.js.map